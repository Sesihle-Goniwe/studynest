<div class="chat-container">
  <header class="chat-header">
    <h2>{{ groupName || 'StudyNest Group Chat' }}</h2>
  </header>

  <!-- Messages -->
  <div class="chat-messages" #chatMessages>
    <div class="message" 
         *ngFor="let msg of messages"
         [ngClass]="msg.userId === currentUserId ? 'own-message' : 'other-message'"
         (contextmenu)="onMessageRightClick($event, msg)">
      
      <!-- Username shown only for other people's messages -->
      <span *ngIf="msg.userId !== currentUserId" class="username">
        {{ msg.fullName || 'Unknown' }}
      </span>

      <!-- The message bubble -->
      <span class="message-text">
        {{ msg.message }}
      </span>

      <!-- Timestamp inside bubble -->
      <span class="time">
        {{ msg.createdAt | date:'shortTime' }}
      </span>
    </div>
  </div>

  <!-- Options Menu -->
  <div #optionsMenu *ngIf="selectedMessage" class="options-menu" 
       [style.top.px]="menuY" [style.left.px]="menuX"
       (click)="$event.stopPropagation()">
    <button type="button" (click)="editMessage(selectedMessage)">Edit</button>
    <button type="button" (click)="deleteMessage(selectedMessage)">Delete</button>
    <button type="button" (click)="closeOptionsMenu()">Cancel</button>
  </div>

  <!-- Input area -->
  <div class="chat-input">
    <input type="text" [(ngModel)]="newMessage" placeholder="Type a message" />
    <button (click)="sendMessage()">Send</button>
  </div>

  <!-- Error Message -->
  <p *ngIf="errorMessage" class="error-msg">{{ errorMessage }}</p>
</div>
